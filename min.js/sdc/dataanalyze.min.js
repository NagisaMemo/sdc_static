class DataPlot extends React.Component{constructor(a){super(a),this.state={type:"",links:"",keys:"",data:""},this.linkstack=[],this.keyword="",this.URLgetJSON=a=>{this.activelink=a,this.serverRequest=$.get(a,this.SetNewState)},this.KeywordgetJSON=a=>{this.keyword=a,this.serverRequest=$.get("/search/"+a,a=>{this.serverRequest=$.get(a.links[0].href,this.SetNewState)})},this.SetNewState=a=>{for(var b=Array(a.resultList.length),c=Array(a.resultList.length),d=Array(a.resultList.length),e=0;e<a.resultList.length;e++)"day"!=a.type&&(c[e]=a.links[e].href),d[e]=a.resultList[e].date,b[e]=a.resultList[e].result;this.setState({type:a.type,links:c,keys:d,data:b})},this.HandleSearch=()=>{this.myChart!=null&&this.myChart.destroy(),this.keyword=$("#searchbox").val(),this.KeywordgetJSON(this.keyword)},this.PlotChart=()=>{var a=$("#myChart");this.myChart=new Chart(a,{type:"line",data:{labels:this.state.keys,datasets:[{label:"data",data:this.state.data}]},options:{responsive:!0,scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})},this.HandleClick=a=>{var b=this.myChart.getElementsAtEvent(a);b.length&&"day"!=this.state.type&&(a.stopPropagation(),this.myChart.destroy(),this.linkstack.push(this.activelink),this.URLgetJSON(this.state.links[b[0]._index]))},this.ReturnUpper=()=>{0<this.linkstack.length&&(this.myChart.destroy(),this.URLgetJSON(this.linkstack.pop()))}}componentDidUpdate(){this.PlotChart()}componentWillUnmount(){this.serverRequest.abort()}render(){return""==this.keyword?React.createElement("div",null,React.createElement("img",{src:"/starsea.png",className:"mainimg"}),React.createElement("input",{className:"maininput",type:"text",id:"searchbox"}),React.createElement("a",{className:"button1 mainsearchbutton",onClick:this.HandleSearch},"SDC\u4E00\u4E0B \u4F60\u5C31\u77E5\u9053")):"month"==this.state.type||"day"==this.state.type?React.createElement("div",null,React.createElement(MyNav,{fun1:this.HandleSearch,keyword:this.keyword}),React.createElement("div",{className:"chartcontainer"},React.createElement("canvas",{id:"myChart",width:"400",height:"400",onClick:this.HandleClick})),React.createElement("a",{className:"button1 mainsearchbutton",onClick:this.ReturnUpper},"\u8FD4\u56DE\u4E0A\u7EA7")):React.createElement("div",null,React.createElement(MyNav,{fun1:this.HandleSearch,keyword:this.keyword}),React.createElement("div",{className:"chartcontainer"},React.createElement("canvas",{id:"myChart",width:"400",height:"400",onClick:this.HandleClick})))}}function MyNav(a){return React.createElement("div",null,React.createElement("div",{id:"navbg"}),React.createElement("div",{id:"navcover"},React.createElement("div",{className:"container"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-2"}),React.createElement("div",{className:"col-xs-8"},React.createElement("input",{className:"subinput",type:"text",id:"searchbox",defaultValue:a.keyword})),React.createElement("div",{className:"col-xs-2"},React.createElement("a",{className:"subsearchbutton",onClick:a.fun1},"\u641C \u7D22"))))))}ReactDOM.render(React.createElement(DataPlot,{source:"/date"}),document.getElementById("example"));
